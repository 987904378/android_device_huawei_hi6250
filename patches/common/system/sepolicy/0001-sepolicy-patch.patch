From c926997bb401fc25078e23123659eb70876144f1 Mon Sep 17 00:00:00 2001
From: Meticulus <theonejohnnyd@gmail.com>
Date: Sat, 8 Apr 2017 09:00:05 -0500
Subject: [PATCH] 0001-sepolicy-patch

Change-Id: I3a0fd8b691620e3ed9be358743881c7e50e8eeb8
---
 domain.te | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/domain.te b/domain.te
index a74833c..eef0774 100644
--- a/domain.te
+++ b/domain.te
@@ -158,6 +158,7 @@ neverallow {
   -vold
   -dumpstate
   -system_server
+  -tee
   userdebug_or_eng(`-perfprofd')
 } self:capability sys_ptrace;
 
@@ -342,11 +343,11 @@ neverallow { domain -recovery } contextmount_type:dir_file_class_set
 # system_app_service rather than the generic type.
 # New service_types are defined in service.te and new mappings
 # from service name to service_type are defined in service_contexts.
-neverallow * default_android_service:service_manager add;
+neverallow { domain -perfhub -hwcamcfgsvr } default_android_service:service_manager add;
 
 # Require that domains explicitly label unknown properties, and do not allow
 # anyone but init to modify unknown properties.
-neverallow { domain -init } default_prop:property_service set;
+neverallow { domain -init -tee } default_prop:property_service set;
 neverallow { domain -init } mmc_prop:property_service set;
 
 neverallow { domain -init -recovery -system_server } frp_block_device:blk_file rw_file_perms;
-- 
1.9.1

